
<!doctype html>
<html lang="fi" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../nlp/">
      
      
        <link rel="next" href="../transformers/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.2">
    
    
      
        <title>RNN ja jälkeläiset - Syväoppiminen I</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#rnn-ja-jalkelaiset" class="md-skip">
          Hyppää sisältöön
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Ylätunniste">
    <a href="../.." title="Syväoppiminen I" class="md-header__button md-logo" aria-label="Syväoppiminen I" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Syväoppiminen I
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              RNN ja jälkeläiset
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Hae" placeholder="Hae" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Haku">
        
        <button type="reset" class="md-search__icon md-icon" title="Tyhjää" aria-label="Tyhjää" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Aloitetaan hakua
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigaatio" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Syväoppiminen I" class="md-nav__button md-logo" aria-label="Syväoppiminen I" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Syväoppiminen I
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tervetuloa kurssille
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    1. Neuroverkot
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    1. Neuroverkot
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroverkot/neuroverkot_101/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Neuroverkot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroverkot/syvaoppiminen_FC/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Syvät neuroverkot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    2. Tensorit
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    2. Tensorit
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tensorit/vektorointi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Vektorointi
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tensorit/pytorch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PyTorch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    3. Vastavirta
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    3. Vastavirta
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vastavirta/backpropagation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Vastavirta (Backprop)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    4. Mallinnus
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    4. Mallinnus
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mallinnus/yleiskatsaus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Yleiskatsaus
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mallinnus/datanlataus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Datan lataus
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mallinnus/kaytannot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kouluttamisen käytännöt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    5. Konvoluutio
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    5. Konvoluutio
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../konvoluutio/cnn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Konvoluutioverkot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    6. Siirtovaikutus
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    6. Siirtovaikutus
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../siirtovaikutus/pretrained/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Koulutetun mallin käyttö
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../siirtovaikutus/transferlearning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Siirtovaikutus
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    7. Kieli
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    7. Kieli
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nlp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Luonnollinen kieli
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    RNN ja jälkeläiset
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    RNN ja jälkeläiset
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Sisällysluettelo">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Sisällysluettelo
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#linkki-aiemmin-opittuun" class="md-nav__link">
    <span class="md-ellipsis">
      
        Linkki aiemmin opittuun
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#motivaatio" class="md-nav__link">
    <span class="md-ellipsis">
      
        Motivaatio
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rnnn-perusidea" class="md-nav__link">
    <span class="md-ellipsis">
      
        RNN:n perusidea
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RNN:n perusidea">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ongelmatyypit-sekvenssidatalle" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ongelmatyypit sekvenssidatalle
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ongelmatyypit sekvenssidatalle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vector-to-vector" class="md-nav__link">
    <span class="md-ellipsis">
      
        Vector-to-Vector
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequence-to-vector" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sequence-to-Vector
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vector-to-sequence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Vector-to-Sequence
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequence-to-sequence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sequence-to-Sequence
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encoder-decoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        Encoder-Decoder
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rnnn-koulutus" class="md-nav__link">
    <span class="md-ellipsis">
      
        RNN:n koulutus
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RNN:n koulutus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unrolling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unrolling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bptt" class="md-nav__link">
    <span class="md-ellipsis">
      
        BPTT
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rajoitteet-ja-ongelmat" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rajoitteet ja ongelmat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ongelmien-mitigointi" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ongelmien mitigointi
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kehittyneemmat-rnn-arkkitehtuurit" class="md-nav__link">
    <span class="md-ellipsis">
      
        Kehittyneemmät RNN-arkkitehtuurit
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kehittyneemmät RNN-arkkitehtuurit">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lstm" class="md-nav__link">
    <span class="md-ellipsis">
      
        LSTM
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gru" class="md-nav__link">
    <span class="md-ellipsis">
      
        GRU
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tehtavat" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tehtävät
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lahteet" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lähteet
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transformers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transformers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    8. Aikasarjat
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    8. Aikasarjat
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aikasarjat/ideat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Aikasarjat
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercises/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tehtäväkooste
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Sisällysluettelo">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Sisällysluettelo
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#linkki-aiemmin-opittuun" class="md-nav__link">
    <span class="md-ellipsis">
      
        Linkki aiemmin opittuun
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#motivaatio" class="md-nav__link">
    <span class="md-ellipsis">
      
        Motivaatio
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rnnn-perusidea" class="md-nav__link">
    <span class="md-ellipsis">
      
        RNN:n perusidea
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RNN:n perusidea">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ongelmatyypit-sekvenssidatalle" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ongelmatyypit sekvenssidatalle
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ongelmatyypit sekvenssidatalle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vector-to-vector" class="md-nav__link">
    <span class="md-ellipsis">
      
        Vector-to-Vector
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequence-to-vector" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sequence-to-Vector
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vector-to-sequence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Vector-to-Sequence
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequence-to-sequence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sequence-to-Sequence
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#encoder-decoder" class="md-nav__link">
    <span class="md-ellipsis">
      
        Encoder-Decoder
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rnnn-koulutus" class="md-nav__link">
    <span class="md-ellipsis">
      
        RNN:n koulutus
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RNN:n koulutus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unrolling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unrolling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bptt" class="md-nav__link">
    <span class="md-ellipsis">
      
        BPTT
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rajoitteet-ja-ongelmat" class="md-nav__link">
    <span class="md-ellipsis">
      
        Rajoitteet ja ongelmat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ongelmien-mitigointi" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ongelmien mitigointi
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kehittyneemmat-rnn-arkkitehtuurit" class="md-nav__link">
    <span class="md-ellipsis">
      
        Kehittyneemmät RNN-arkkitehtuurit
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kehittyneemmät RNN-arkkitehtuurit">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lstm" class="md-nav__link">
    <span class="md-ellipsis">
      
        LSTM
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gru" class="md-nav__link">
    <span class="md-ellipsis">
      
        GRU
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tehtavat" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tehtävät
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lahteet" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lähteet
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="rnn-ja-jalkelaiset">RNN ja jälkeläiset</h1>
<h2 id="linkki-aiemmin-opittuun">Linkki aiemmin opittuun</h2>
<p>Edellisessä osiossa keskityimme paljolti termiin <em>embedding</em>. Käsitteen ymmärtäminen helpottaa merkittävästi RNN:n ja sen seuraajien, kuten LSTM:n ja GRU:n, toimintaperiaatteen ymmärtämistä. Jos olet epävarma, kannattaa kerrata edellistä osiota ja käydä kävelyllä tai nukkua yön yli.</p>
<p>Toinen käsite, mikä kannattaa palauttaa mieleen, on <em>shared weights</em> eli jaetut painot. RNN:ssä, kuten konvoluutioverkoissakin, käytetään jaettuja painoja, mikä tarkoittaa, että samaa painojoukkoa käytetään useissa eri kohdissa verkkoa. Konvoluutioverkon kohdalla tämä on intuitiivista, koska paino on <em>kernel</em> eli suodatin, jonka vaikutusta kuvaan voi tarkastella visuaalisesti. RNN:ssä jaettu paino on konseptuaalisesti sama, mutta sen visualisointi on vaikeampaa, koska RNN käsittelee sekvenssidataa. Ihmismielellä on vaikeampi käsittää, kuinka samoja painoja voi soveltaa esimerkiksi lauseen eri sanoihin (tai siis niiden <em>embedding</em>-esityksiin).</p>
<p><img alt="" src="../../images/710_fc_conv_rnn_comparison.png" /></p>
<p><strong>Kuva 1:</strong> <em>Kaksi tuttua ja tuore tuttavuus vierekkäin. Konvoluutioverkko vähensi parametrien määrää hyödyntämällä paikallista rakennetta, jolloin kaikkea ei kytketä kaikkeen. RNN sen sijaan hyödyntää datan sekvenssiluonnetta, jolloin se voi hyödyntää aiempaa tietoa nykyisen syötteen käsittelyssä. Sivuun piirretty nuoli vie pieneen laatikkoon: yksi per neuroni. Tämä mahdollistaa "muistin", koska aktivoinnin vaikutus akkumuloituu tähän muuttujaan, joka on seuraavan syötteen käsittelyn laskennan osaksi. <sup id="fnref:ldl"><a class="footnote-ref" href="#fn:ldl">1</a></sup></em></p>
<p>RNN:n ja CNN:n eroavaisuuksista kannattaa jo heti hyväksyä se, että <mark>konvoluutioverkko vaatii tietyn kokoisen inputin</mark>. Sen sijaan RNN tarvitsee vain saman kokoisen <em>embedding</em>-esityksen, mutta sekvenssin pituus voi vaihdella. Tämä mahdollistaa sen, että <mark>RNN pärjää eri mittaisten lauseiden kanssa</mark>. Konvoluutioverkkoa <em>voi</em> siis käyttää <code>Conv1D</code>-hengessä käsittelemään lauseita, mutta tällöin täytyy määritellä maksimipituus ja lyhentää tai täyttää lauseet sopiviksi. RNN:ssä tätä ei tarvita. Tämä on merkittävä etu lauseiden kanssa, jotka ovat luonnostaan eri mittaisia.</p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Tässä on sekaannuksen vaara läsnä, joten korostetaan asiaa. RNN:kin tarvitsee paddingia <strong>batch-käsittelyä varten</strong>, mutta se ei vaadi sitä yksittäisen lauseen käsittelyyn.</p>
</div>
<h2 id="motivaatio">Motivaatio</h2>
<p>RNN:t ovat neuroverkkoarkkitehtuuri, joka on suunniteltu käsittelemään sekvenssidataa, kuten tekstiä, ääntä tai aikasarjoja. On tärkeää painottaa sanaa <em>toistuva</em> tai <em>sekvenssi</em>. Ratkomme samankaltaisia ongelmia kuin aiemmin kurssilla, mutta nyt data on järjestetty sekvensseiksi: peräkkäisyys voi olla selkeä temporaalinen järjestys, kuten aikasarjoissa, tai ihan vain sanojen peräkkäisyys lauseessa.</p>
<p>Alla on taulukko, joka havainnollistaa erilaisten ongelmatyyppien ratkaisua. Taulukko mukailee Magnus Ekmanin vastaavaa <sup id="fnref2:ldl"><a class="footnote-ref" href="#fn:ldl">1</a></sup>. Alempi rivi edustaa sekvenssidataa eli tämän viikon aihetta, ylempi rivi on aiemmilta viikoilta tuttua kauraa:</p>
<table>
<thead>
<tr>
<th></th>
<th>Regressio</th>
<th>Luokittelu</th>
<th>Multiclass luokittelu</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Ei-sekvenssi</strong></td>
<td>Ennusta talon hinta</td>
<td>Tunnista sairaus</td>
<td>Tunnista MNIST-digit</td>
</tr>
<tr>
<td><strong>Sekvenssi</strong></td>
<td>Ennusta ensi kuun kysyntä</td>
<td>Tunnista sataako huomenna</td>
<td>Ennusta seuraava sana lauseessa</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Joissakin kirjoissa/kursseissa käsitellään ensin aikasarjat, toisissa kielelliset ongelmat. Tällä kursilla on valittu aloittaa kielellisistä ongelmista, koska ne ovat intuitiivisia heti ensivilkaisulla: lauseiden kääntämistä kielestä toiseen ja niin edelleen. Lisäksi suurten kielimallin (LLM) suosion takia meillä kaikilla on jokin kosketuspinta tämän tyypin koneoppimismalleihin loppukäyttäjän näkökulmasta.</p>
</div>
<h2 id="rnnn-perusidea">RNN:n perusidea</h2>
<blockquote>
<p>"A recurrent neural network (RNN) is a neural network that consists of a hidden state <span class="arithmatex">\(h\)</span> and an
optional output <span class="arithmatex">\(y\)</span> which operates on a variable length sequence <span class="arithmatex">\(x = (x_1, \ldots, x_T)\)</span>. At each time
step <span class="arithmatex">\(t\)</span>, the hidden state <span class="arithmatex">\(h_{t}\)</span> of the RNN is updated by ..."</p>
<p>— Cho et. al. <sup id="fnref2:gru"><a class="footnote-ref" href="#fn:gru">2</a></sup></p>
</blockquote>
<p>Yllä esitellyssä kuvassa RNN:ään kuuluivat verkon takaisinkytkentään liittyvät pienet keltaiset laatikot. Näistä voi käyttää termiä <em>hidden state</em>. Kuten kuvatekstissä sanottiin, nämä käytännössä edustavat <code>accumulator</code>-muuttujaa loopissa. Tarkastellaan tätä lyhyen kuvitteellisen Python-toteutuksen avulla:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Hyperparametrit</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">embedding_size</span> <span class="o">=</span> <span class="mi">4</span>   <span class="c1"># Embedding-vektorin pituus (d_x)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">hidden_size</span>    <span class="o">=</span> <span class="mi">3</span>   <span class="c1"># Hidden state -vektorin pituus (d_h)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="c1"># Embedding on vektori, joka edustaa sanaa.</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">vec_I</span>    <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span>   <span class="c1"># sana &quot;I&quot;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="c1"># Lauseet ovat listoja näistä vektoreista:</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="c1"># &quot;I am not an&quot;      → 4 sanaa → 4 aika-askelta</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="c1"># &quot;I will not buy&quot;   → 4 sanaa → 4 aika-askelta</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">sentence1</span><span class="p">,</span> <span class="n">target1</span> <span class="o">=</span> <span class="p">([</span><span class="n">vec_I</span><span class="p">,</span> <span class="n">vec_am</span><span class="p">,</span>   <span class="n">vec_not</span><span class="p">,</span> <span class="n">vec_an</span><span class="p">],</span>  <span class="n">label_A</span><span class="p">)</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">sentence2</span><span class="p">,</span> <span class="n">target2</span> <span class="o">=</span> <span class="p">([</span><span class="n">vec_I</span><span class="p">,</span> <span class="n">vec_will</span><span class="p">,</span> <span class="n">vec_not</span><span class="p">,</span> <span class="n">vec_buy</span><span class="p">],</span> <span class="n">label_B</span><span class="p">)</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">batch</span> <span class="o">=</span> <span class="p">[(</span><span class="n">sentence1</span><span class="p">,</span> <span class="n">target1</span><span class="p">),</span> <span class="p">(</span><span class="n">sentence2</span><span class="p">,</span> <span class="n">target2</span><span class="p">)]</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="k">for</span> <span class="n">sentence</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">:</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="c1"># Nollataan muisti jokaisen lauseen alussa!</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    <span class="n">hidden_state</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">hidden_size</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="k">for</span> <span class="n">word_vector</span> <span class="ow">in</span> <span class="n">sentence</span><span class="p">:</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>        <span class="c1"># Joka aika-askeleella RNN saa syötteeksi:</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>        <span class="c1">#   1) nykyisen sanan embedding-vektorin</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>        <span class="c1">#   2) edellisen aika-askeleen hidden staten</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>        <span class="c1"># ja palauttaa uuden hidden staten.</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>        <span class="n">hidden_state</span> <span class="o">=</span> <span class="n">rnn_cell</span><span class="p">(</span><span class="n">word_vector</span><span class="p">,</span> <span class="n">hidden_state</span><span class="p">)</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>    <span class="c1"># Silmukan jälkeen hidden_state on tiivistelmä koko lauseesta.</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>    <span class="c1"># Tämän perusteella tehdään ennustus ja lasketaan virhe.</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>    <span class="n">prediction</span> <span class="o">=</span> <span class="n">output_layer</span><span class="p">(</span><span class="n">hidden_state</span><span class="p">)</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>    <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_function</span><span class="p">(</span><span class="n">prediction</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>    <span class="c1"># backpropagation kulkee kaikkien aika-askelten läpi (BPTT)</span>
</span></code></pre></div>
<p>Matemaattisesti sekä koodina RNN-mallin yhden <code>rnn_cell</code>:n laskenta, jota lasketaan loopissa, on <sup id="fnref3:ldl"><a class="footnote-ref" href="#fn:ldl">1</a></sup> <sup id="fnref:geronpytorch"><a class="footnote-ref" href="#fn:geronpytorch">3</a></sup>:</p>
<div class="arithmatex">\[
h^{(t)} = \sigma(W \cdot h^{(t-1)} + U \cdot x^{(t)} + b)
\]</div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">rnn_cell</span><span class="p">(</span><span class="n">x_t</span><span class="p">,</span> <span class="n">h_prev</span><span class="p">):</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>    <span class="n">h_part</span> <span class="o">=</span> <span class="n">W</span> <span class="o">@</span> <span class="n">h_prev</span>   <span class="c1"># shapes: (d_h, d_h) @ (d_h,) → (d_h,)</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    <span class="n">x_part</span> <span class="o">=</span> <span class="n">U</span> <span class="o">@</span> <span class="n">x_t</span>      <span class="c1"># shapes: (d_h, d_x) @ (d_x,) → (d_h,)</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>    <span class="n">h_t</span> <span class="o">=</span> <span class="n">tanh</span><span class="p">(</span><span class="n">x_part</span> <span class="o">+</span> <span class="n">h_part</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>    <span class="k">return</span> <span class="n">h_t</span>
</span></code></pre></div>
<p>Muuttujat ovat selitettynä alla:</p>
<ul>
<li><span class="arithmatex">\(t\)</span> on aika-askel, joka vastaa sanan sijaintia lauseessa (<span class="arithmatex">\(t=0, 1, 2, \ldots\)</span>).</li>
<li><span class="arithmatex">\(x^{(t)}\)</span> on syötevektori ajanhetkellä <span class="arithmatex">\(t\)</span> eli kyseisen sanan <em>embedding</em>. <ul>
<li>Koko: <span class="arithmatex">\(d_x\)</span> (embedding_size).</li>
</ul>
</li>
<li><span class="arithmatex">\(h^{(t)}\)</span> on <em>hidden state</em> ajanhetkellä <span class="arithmatex">\(t\)</span>. Tämä on verkon "muisti". <ul>
<li>Koko: <span class="arithmatex">\(d_h\)</span> (hidden_size).</li>
</ul>
</li>
<li><span class="arithmatex">\(h^{(t-1)}\)</span> on edellisen aika-askeleen hidden state. Alussa (<span class="arithmatex">\(t=0\)</span>) tämä on tyypillisesti nollavektori.</li>
<li><span class="arithmatex">\(W\)</span> on <span class="arithmatex">\(d_h \times d_h\)</span> painomatriisi, joka painottaa edellistä hidden statea.</li>
<li><span class="arithmatex">\(U\)</span> on <span class="arithmatex">\(d_h \times d_x\)</span> painomatriisi, joka painottaa nykyistä syötevektoria.</li>
<li><span class="arithmatex">\(b\)</span> on bias-vektori (koko <span class="arithmatex">\(d_h\)</span>).</li>
<li><span class="arithmatex">\(\sigma\)</span> on aktivointifunktio, tyypillisesti tanh.</li>
</ul>
<p>Huomaa, että <span class="arithmatex">\(d_h\)</span> (hidden_size) on vapaasti valittava hyperparametri — se <strong>ei</strong> ole sama kuin lauseen pituus. Huomaa myös, että painomatriisit <span class="arithmatex">\(W\)</span> ja <span class="arithmatex">\(U\)</span> sekä bias <span class="arithmatex">\(b\)</span> ovat <strong>jaettuja painoja</strong>: samaa matriisia ja vektoria käytetään kaikissa aika-askeleissa.</p>
<p>Tässä vaiheessa nohevilla opiskelijoilla on toivon mukaan kysymyksiä mielissään. Yksi selkeä kysymysaihio on, että jos batch:n on oltava matriisi (joka kerrotaan painomatriisilla <span class="arithmatex">\(U\)</span>), niin miten lauseet tai tekstit, jotka ovat eri mittaisia, mahtuvat samaan matriisiin? Juurihan yllä todettiin, että RNN ei vaadi tietyn mittaisia syötteitä. Naiivi vastaus olisi pitää <code>batch_size</code> 1:ssä eli toteuttaa pedanttinen SGD. Tämä on toki mahdollista, mutta ei tehokasta. </p>
<p>Ratkaisu on lisätä täytettä (PAD) syötteen loppuun. Yksittäinen batch-Tensor on siis muotoa <code>(samples, sequence_length, features)</code>, missä <code>max_sentence_length</code> on suurimman samplen pituus batch:ssä, ja <code>features</code> on embedding. Alla on datasetti, jossa on muutamia sampleja. Ensimmäinen on kenties satu: <em>"Once (upon a ... and lived) happily ever after"</em>. Toinen lienee Raamattu: <em>"Alussa (loi Jumala ... olkoon kaikkien) kanssa. Amen"</em>. Alimmat näkyvät samplet ovat pari sanaa lyhyempiä, joten ne loppuvat keltaisella värillä korostettuun <code>vec_PAD</code>-täytteeseen, joka on siis <span class="arithmatex">\(d_x\)</span>-ulotteinen <em>embedding</em> siinä missä kaikki muutkin tokenit. <sup id="fnref:llmfromscratch"><a class="footnote-ref" href="#fn:llmfromscratch">4</a></sup></p>
<table>
<thead>
<tr>
<th></th>
<th>t=0</th>
<th>...</th>
<th>t=max-2</th>
<th>t=max-1</th>
<th>t=max</th>
</tr>
</thead>
<tbody>
<tr>
<td>sample1</td>
<td>vec_Once</td>
<td>...</td>
<td>vec_happily</td>
<td>vec_ever</td>
<td>vec_after</td>
</tr>
<tr>
<td>sample2</td>
<td>vec_Alussa</td>
<td>...</td>
<td>vec_kanssa</td>
<td>vec_DOT</td>
<td>vec_Amen</td>
</tr>
<tr>
<td>sample3</td>
<td>vec_Turussa</td>
<td>...</td>
<td>vec_END</td>
<td><mark>vec_PAD</mark></td>
<td><mark>vec_PAD</mark></td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td>sampleN</td>
<td>vec_Olipa</td>
<td>...</td>
<td>vec_Loppu</td>
<td><mark>vec_PAD</mark></td>
<td><mark>vec_PAD</mark></td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Jos haluat, voit tutustua PyTorchin <a href="https://docs.pytorch.org/docs/stable/generated/torch.nn.utils.rnn.pad_packed_sequence.html">torch.nn.utils.rnn.pad_packed_sequence</a> funktioon. Tämän käyttöä käsitellään Géronin kirjassa luvussa 14. <sup id="fnref11:geronpytorch"><a class="footnote-ref" href="#fn:geronpytorch">3</a></sup></p>
</div>
<h3 id="ongelmatyypit-sekvenssidatalle">Ongelmatyypit sekvenssidatalle</h3>
<p>Alla oleva jako tyyppeihin on peräisin Andrej Karpathyn blogipostauksesta otsikolla <a href="https://karpathy.github.io/2015/05/21/rnn-effectiveness/">The Unreasonable Effectiveness of Recurrent Neural Networks</a>, joka on yksi RNN:n klassikkolähteistä. Jaottelu on hyvin intuitiivinen ja auttaa hahmottamaan, millaisiin ongelmiin RNN:t sopivat. <sup id="fnref:karpathy"><a class="footnote-ref" href="#fn:karpathy">5</a></sup></p>
<p><img alt="" src="../../images/710_rnn_taxonomy.png" /></p>
<p><strong>Kuva 2:</strong> <em>RNN-arkkitehtuurien taksonomia. <sup id="fnref2:karpathy"><a class="footnote-ref" href="#fn:karpathy">5</a></sup> <sup id="fnref2:geronpytorch"><a class="footnote-ref" href="#fn:geronpytorch">3</a></sup></em></p>
<h4 id="vector-to-vector">Vector-to-Vector</h4>
<p>Tämä taksonomian yksinkertaisin malli voidaan käsitellä hyvin lyhyesti: siitä puuttuu hidden state ja koko <code>R</code>-kirjaimen tarkoittama <em>recurrent</em> -elementti. Sisään menee <code>d_x</code>-ulotteinen vektori ja ulos tulee <code>d_y</code>-ulotteinen vektori (tai skaalari). Tämä on siis perinteinen feedforward-verkko eli kurssilta tuttu MLP. Se on käytännössä mukana vain kuriositeettina. <sup id="fnref3:karpathy"><a class="footnote-ref" href="#fn:karpathy">5</a></sup></p>
<h4 id="sequence-to-vector">Sequence-to-Vector</h4>
<p>Tässä "many-to-one" -mallissa syötesekvenssi, kuten tekstilause tai ääninäyte, käsitellään aikasarjana ja tiivistetään yhdeksi tulosvektoriksi, jota käytetään tyypillisesti luokittelutehtävissä, kuten tunneanalyysissa tai roskapostin tunnistuksessa. <sup id="fnref3:geronpytorch"><a class="footnote-ref" href="#fn:geronpytorch">3</a></sup></p>
<p>Tällaisen löydät harjoituksesta <code>713_nvidia_language_model_embedding.py</code>. Vaikka malli inferenssivaiheessa tuottaa useita sanoja peräkkäin, arkkitehtuuri on many-to-one: se ennustaa aina yhden seuraavan sanan kerrallaan ja tulosta syötetään takaisin mallille (autoregressio).</p>
<h4 id="vector-to-sequence">Vector-to-Sequence</h4>
<p>Tämä "one-to-many" -arkkitehtuuri ottaa syötteenään yhden vektorin, esimerkiksi kuvan piirrevektorin, ja tuottaa siitä sarjan tuloksia, mikä on yleistä esimerkiksi kuvatekstien automaattisessa generoinnissa, jossa kuvasta luodaan sanajono. <sup id="fnref4:karpathy"><a class="footnote-ref" href="#fn:karpathy">5</a></sup> Toinen esimerkki voisi olla nimen generointi, jossa syötteenä on henkilön kotimaa (vektoroituna One-Hot -esityksenä) ja mallin tavoitteena on tuottaa sarja merkkejä, jotka muodostavat sukunimen. Tähän liittyy myöhemmin tehtävä.</p>
<h4 id="sequence-to-sequence">Sequence-to-Sequence</h4>
<p>Tämä on <em>many-to-many</em> -malli, joka on Karparthyn sanoin <em>synced sequence input and output</em>. Toisin sanoen sisään menee <span class="arithmatex">\(n\)</span>-mittarinen sekvenssi ja ulos tulee <span class="arithmatex">\(n\)</span>-mittarinen sekvenssi – eli yhtä pitkä syöte ja tuloste. Sinänsä se siis on <em>seq2seq</em>, mutta käytännössä tätä termiä käytetään kokemukseni mukaan lähinnä sellaiseen malliin, jossa syöte ja tuloste voivat olla eri mittaisia, kuten kielenkäännöksessä. Tämä on siis <em>synced</em> seq2seq, joka ei ole sama asia kuin encoder-decoder, joka esitellään alla.</p>
<p>Esimerkkinä <em>many-to-many</em>-malleista voisi olla videon kehysten luokittelu, jossa jokaiselle kehyssekvenssin kehykselle halutaan tuottaa luokitus <sup id="fnref5:karpathy"><a class="footnote-ref" href="#fn:karpathy">5</a></sup>. Tai kenties syöte on lista sanoja, ja ulos lista binääriluokittimen tuloksia, että onko kyseinen sana verbi.</p>
<h4 id="encoder-decoder">Encoder-Decoder</h4>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Tämä on kurssin kannalta edistynyt käsite, ja sitä käsitellään Géronin kirjassa koko luku 14. Tämän 5 opintopisteen kurssin puitteissa emme ehdi syventyä tähän aiheeseen. Käsitellään se vain maininnan tasolla. Harjoituksessa <code>712_seq2seq_translation_tutorial.py</code> tutustut tähän koodin kautta.</p>
<p>Jos haluat tutustua aiheeseen syvemmin kurssin laajuuden ulkopuolella, esimerkiksi projektien yhteydessä, voit aloittaa lukemalla Géronin kirjan loppuun ja tutustumalla julkaisuihin, joita kyseinen <a href="https://docs.pytorch.org/tutorials/intermediate/seq2seq_translation_tutorial.html">PyTorch tutoriaali</a> suosittelee. Etsi sivulta väliotsikko "Recommended Reading".</p>
</div>
<p>Encoder-Decoder on toteutustavaltaan Sequence-to-Sequence -malli, mutta <em>synced</em>-ominaisuus on poistettu. Arkkitehtuuri on täten kaksivaiheinen: ensin <em>Encoder</em> lukee koko syötteen (esim. englanninkielisen lauseen) ja tiivistää sen yhdeksi kontekstivektoriksi (<em>state</em>), jonka jälkeen <em>Decoder</em> purkaa tuon vektorin halutuksi tulosteeksi (esim. ranskankieliseksi lauseeksi), mahdollistaen näin syötteen ja tulosteen eroavat pituudet ja irrelevanssin aikajärjestyksen suhteen. <sup id="fnref4:geronpytorch"><a class="footnote-ref" href="#fn:geronpytorch">3</a></sup> Termistön suhteen huomio, että encoder-decoder välissä vektori tunnetaan monilla nimillä. Voit törmätä ainakin seuraaviin termeihin: <em>context vector, state vector, thought vector, latent vector</em>.</p>
<p>Arkkitehtuurissa on seq2vec -malli, <em>encoder</em>, jonka perään on kytketty vec2seq -malli, <em>decoder</em>. Encoder lukee koko syötteen ja tiivistää sen yhdeksi vektoriksi, joka tunnetaan nimellä <em>context vector</em>. Yllä (Kuvassa 2) vain Encoder-osuus saa syötteen: tämä johtuu siitä, että piirroksessa kyseessä on ulkoinen syöte. Decoder toki saa syötteen, mutta se on oma edellisen aika-askeleensa ennuste. Koulutusvaiheessa Decoder saa toki ulkoisen syötteen (eli ground-truth-sekvenssin). Tämä liittyy <em>teacher forcing</em> -tekniikkaan, jossa mallia ohjataan oikeaan suuntaan syöttämällä sille oikeat vastaukset, kun taas inferenssivaiheessa malli joutuu luottamaan omiin ennusteisiinsa. <sup id="fnref2:llmfromscratch"><a class="footnote-ref" href="#fn:llmfromscratch">4</a></sup></p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Sekaannusvaara, taas.</p>
<ul>
<li>Synced many-to-many: Joka aika-askeleella tuotetaan output (esim. NER-taggaus, videon kehysluokittelu). Tämä ei ole encoder-decoder.</li>
<li>Encoder-Decoder: Encoder lukee ensin koko syötteen, sitten decoder tuottaa tulosteen. Syöte ja tuloste voivat olla eri pituisia. Konvention mukaan tämä on synonyymi seq2seq:lle.</li>
</ul>
</div>
<p>Encoder-Decoder voidaan toteuttaa kahdella erillisellä <code>nn.Module</code>-luokalla, kuten <code>EncoderRNN</code> ja <code>DecoderRNN</code> (ks. <code>712_seq2seq_translation_tutorial.py</code>), tai yhdellä luokalla, jossa encoder- ja decoder-vaiheet ovat saman <code>forward()</code>-metodin
sisällä. Se, onko tai eikö ole kahta eri luokkaa, ei yksin määrittele arkkitehtuuria — ero syntyy siitä, onko kyseessä <em>synced</em> vai <em>unsynced</em> many-to-many.</p>
<h2 id="rnnn-koulutus">RNN:n koulutus</h2>
<h3 id="unrolling">Unrolling</h3>
<p>Yllä käytetty <code>for</code>-loop on vastavirta eli <em>backpropagation</em> algoritmin kannalta huono. Muuttuja <code>hidden_state</code> on akkumulaattori, joka ylikirjoitetaan joka aika-askeleella, joten menneiden aika-askelten aktivointeja ei ole tallessa. RNN:n koulutuksessa käytetäänkin <em>unrolling</em> -tekniikkaa, jossa verkko "puretaan" useiksi kopioiksi, jotka on kytketty toisiinsa. Kuinka useaksi kopioksi? Batchen suurimman sekvenssin pituuden verran. <sup id="fnref4:ldl"><a class="footnote-ref" href="#fn:ldl">1</a></sup> <sup id="fnref5:geronpytorch"><a class="footnote-ref" href="#fn:geronpytorch">3</a></sup></p>
<p><img alt="" src="../../images/710_rnn_unroll.png" /></p>
<p><strong>Kuva 3:</strong> <em>RNN:n "unrolling" eli purkaminen. Katkoviivat edustavat sitä, että verkko voi olla jonkin yllämainitun taksonomien mukainen. Kustakin RNN-solusta lähtevä arvo joko osallistuu tai ei osallistu lopulliseen lähtöön, riippuen siitä, minkä tyyppisestä ongelmasta on kyse. <sup id="fnref5:ldl"><a class="footnote-ref" href="#fn:ldl">1</a></sup> <sup id="fnref6:geronpytorch"><a class="footnote-ref" href="#fn:geronpytorch">3</a></sup></em></p>
<h3 id="bptt">BPTT</h3>
<p>Kun verkko on avattu, se on tavallinen feedforward-verkko. Voimme siis käyttää tavallista backpropagation-algoritmia. Termi tälle koko strategialle on <em>Backpropagation Through Time</em> (BPTT). Algoritmi on siis sama kuin ennenkin, mutta koska prosessiin liittyy temporaalinen elementti, sille on annettu nimi. <sup id="fnref6:ldl"><a class="footnote-ref" href="#fn:ldl">1</a></sup> <sup id="fnref7:geronpytorch"><a class="footnote-ref" href="#fn:geronpytorch">3</a></sup></p>
<p><img alt="" src="../../images/710_rnn_linear.png" /></p>
<p><strong>Kuva 4:</strong> <em>Muista, että RNN on vain lineaarinen verkko, joka on avattu useiksi kopioiksi. Meillä on yhä jokin loss function, jonka haluamme minimoida, ja usein ennen tätä on Linear-kerros, joka muuttaa hidden state -vektorin halutun kokoiseksi outputiksi.</em></p>
<h3 id="rajoitteet-ja-ongelmat">Rajoitteet ja ongelmat</h3>
<p>Syvät verkot kärsivät ongelmasta <em>vanishing</em> ja <em>exploding gradient</em>, johon olet törmännyt kurssin tehtävissä aiemmin. Kun luku kerrotaan useita kertoja peräkkäin <code>&lt; 1</code> luvulla, kuten vaikka <code>0.25</code>, luku lähestyy nollaa. Jos se kerrotaan useita kertoja <code>&gt; 1</code> luvulla, kuten <code>1.25</code>, luku kasvaa eksponentiaalisesti. RNN:ssä tämä tapahtuu, koska sama painomatriisi, <span class="arithmatex">\(W\)</span> tai <span class="arithmatex">\(U\)</span>, kerrotaan useita kertoja peräkkäin. Jos RNN:stä tekee syvän, kuten alla olevassa kuvassa, ongelma luonnollisesti pahenee. <sup id="fnref7:ldl"><a class="footnote-ref" href="#fn:ldl">1</a></sup></p>
<p><img alt="" src="../../images/710_rnn_multilayer.png" /></p>
<p><strong>Kuva 5:</strong> <em>Monikerroksinen RNN. Violetilla ja punaisella värillä on korostettu sitä, että kaikki saman kerroksen neuronit jakavat <span class="arithmatex">\(W_k\)</span> painon, kuten myös <span class="arithmatex">\(U_k\)</span> painon.<sup id="fnref8:ldl"><a class="footnote-ref" href="#fn:ldl">1</a></sup> <sup id="fnref8:geronpytorch"><a class="footnote-ref" href="#fn:geronpytorch">3</a></sup></em></p>
<p>Syvyyden lisääminen RNN:ään pahentaa entisestään <em>vanishing</em> ja <em>exploding gradient</em> -ongelmia, jotka ovat RNN:n suurimpia haasteita. Kuvittele, että haluat selvittää <span class="arithmatex">\(U_1\)</span>:n eli ensimmäisen kerroksen jaettua painomatriisia, jolla <span class="arithmatex">\(x^{(t)}\)</span> kerrotaan. Tämä matriisi on mukana <mark>jokaisessa kerroksessa</mark>, joten gradientti kulkee läpi kaikkien kerrosten, mikä tarkoittaa, että se kerrotaan useita kertoja peräkkäin. <sup id="fnref9:ldl"><a class="footnote-ref" href="#fn:ldl">1</a></sup></p>
<h3 id="ongelmien-mitigointi">Ongelmien mitigointi</h3>
<p>Alla on Learning Deep Learning -kirjan <sup id="fnref10:ldl"><a class="footnote-ref" href="#fn:ldl">1</a></sup> taulukon suomennettu ja tiivistetty versio, jossa on esiteltynä yleisiä tapoja yrittää mitigoida katoavia (<em>engl. vanishing</em>) ja räjähtäviä (<em>engl. exploding</em>) gradientteja RNN:issä. Se, auttaako kyseinen tekniikka katoaviin vai räjähtäviin gradientteihin, on merkitty taulukossa emojein.</p>
<table>
<thead>
<tr>
<th>Tekniikka</th>
<th>Katoava</th>
<th>Räjähtävä</th>
<th>Huomiot</th>
</tr>
</thead>
<tbody>
<tr>
<td>Glorot tai He valinta</td>
<td>✅</td>
<td>⛔</td>
<td>Riippuu aktivointifunktiosta.</td>
</tr>
<tr>
<td>Batch Normalization</td>
<td>✅</td>
<td>⛔</td>
<td>Puree piilotettuihin kerroksiin</td>
</tr>
<tr>
<td>Ei-saturoituva aktivointi</td>
<td>✅</td>
<td>⛔</td>
<td>Esim. ReLU</td>
</tr>
<tr>
<td>Gradient Clipping</td>
<td>⛔</td>
<td>✅</td>
<td>Puree kaikkiin kerroksiin</td>
</tr>
<tr>
<td>CEC + Portit</td>
<td>✅</td>
<td>✅</td>
<td>Lue alta LSTM:n kohdalta lisää</td>
</tr>
</tbody>
</table>
<h2 id="kehittyneemmat-rnn-arkkitehtuurit">Kehittyneemmät RNN-arkkitehtuurit</h2>
<h3 id="lstm">LSTM</h3>
<p>Hochreiter ja Schmidhuberin vuonna 1997 esittelemä LSTM on RNN-variantti, joka on suunniteltu keventämään RNN:n vanishing gradient -ongelmaa sekä parantamaan pitkäaikaista muistin säilyttämistä. Räjähtävät ja katoavat gradientit ovat oire siitä, että <span class="arithmatex">\(W\)</span>-painomatriisin arvot ovat erisuuria kuin <span class="arithmatex">\(1\)</span>. Ekman kirjoittaa: <em>"[...] with a large enough number of timesteps, the only way to avoid vanishing and exploding gradients is to use weights with a value of 1, which kind of defeats the purpose because we want to be able to adjust the weights"</em> <sup id="fnref11:ldl"><a class="footnote-ref" href="#fn:ldl">1</a></sup>. Mallin kouluttamisen idea on säätää painoja, joten painojen pitäminen kiinteästi arvossa 1 ei ole ratkaisu. Tästä äärimmäisen naiivista ajatuksesta on kuitenkin johdettavissa <em>constant error carousel</em> -tekniikka, joka on LSTM:n ydin. <sup id="fnref:lstm"><a class="footnote-ref" href="#fn:lstm">6</a></sup> Julkaisun tiivistelmässä tämä avataan näin: <em>"Multiplicative
gate units learn to open and close access to the constant error flow"</em> <sup id="fnref2:lstm"><a class="footnote-ref" href="#fn:lstm">6</a></sup>. Tyypillisen LSTM-solun kuvauksen sijasta, joka löytyy vaikkapa Géronin kirjasta, alla on kuva, jossa korostetaan, kuinka kaksi LSTM-solua kytkeytyvät toisiinsa. Kuvaa kannattaa tuijottaa siten, että sinulla on saatavilla myös tyypillinen LSTM-solun kuva (esim. Figure 13-12 Géronin kirjasta). Myös alkuperäisen julkaisun Figure 1 on hyödyllinen ymmärryksen apuna, mutta sen kohdalla on syytä huomioida, että esitelty malli on naiivi LSTM, jossa cell state -yhteyden paino on kiinteästi 1 (constant error carousel), eli cell state kulkee muuttumattomana eteenpäin ilman kertoimen vaikutusta. <sup id="fnref3:lstm"><a class="footnote-ref" href="#fn:lstm">6</a></sup> Alkuperäisestä 1997 LSTM:stä et myöskään löydä <em>forget gate</em> -mekanismia, joka on myöhemmin lisätty LSTM:ään. <sup id="fnref:lstm-forget"><a class="footnote-ref" href="#fn:lstm-forget">7</a></sup></p>
<p><img alt="" src="../../images/710_LSTM_architecture.png" /></p>
<p><strong>Kuva 6:</strong> <em>LSTM-arkkitehtuuri. Kuvassa on kaksi LSTM-solua. Kuvaaja pyrkii yhdistämään eri lähteistä vastaavien kuvaajien parhaat puolet <sup id="fnref9:geronpytorch"><a class="footnote-ref" href="#fn:geronpytorch">3</a></sup> <sup id="fnref12:ldl"><a class="footnote-ref" href="#fn:ldl">1</a></sup> <sup id="fnref4:lstm"><a class="footnote-ref" href="#fn:lstm">6</a></sup>. Oikeanpuoleiseen soluun on merkitty pienin numeroin, <code>(1)...(6)</code>, vaiheet, jotka ovat alla matemaattisina kaavoina.</em></p>
<p>LSTM:ssä on kolme porttia ja lisäksi <em>candidate</em>, jotka kaikki tuottavat <span class="arithmatex">\(d_h\)</span> ulotteisia vektoreita, jotka osallistuvat laskentaan. Yhdessä nämä neljä ovat:</p>
<ul>
<li><strong>Forget gate</strong>: Päätös siitä, mitä tietoa vanhasta <em>cell state</em> -vektorista säilytetään tai unohdetaan. Käytetään sigmoid-aktivointia, joka tuottaa arvoja välillä 0 (unohtaa kaiken) ja 1 (säilyttää kaiken). <sup id="fnref12:geronpytorch"><a class="footnote-ref" href="#fn:geronpytorch">3</a></sup></li>
<li><strong>Input gate</strong>: Päätös siitä, mitä uutta tietoa syötteestä lisätään <em>cell state</em> -vektoriin. <sup id="fnref13:geronpytorch"><a class="footnote-ref" href="#fn:geronpytorch">3</a></sup></li>
<li><strong>Output gate</strong>: Päätös siitä, mitä tietoa <em>cell state</em> -vektorista käytetään nykyisen aika-askeleen outputiksi. <sup id="fnref14:geronpytorch"><a class="footnote-ref" href="#fn:geronpytorch">3</a></sup></li>
<li><strong>Candidate</strong>: Tuottaa ehdotetun uuden informaation, joka voidaan lisätä <em>cell state</em> -vektoriin, perustuen nykyiseen syötteeseen ja edelliseen hidden stateen. <sup id="fnref13:ldl"><a class="footnote-ref" href="#fn:ldl">1</a></sup></li>
</ul>
<p>Kuvasta ja lähteistä voi koostaa, että:</p>
<ul>
<li>LSTM-solut jakavat neljä painomatriisia: <span class="arithmatex">\(W_f\)</span>, <span class="arithmatex">\(W_i\)</span>, <span class="arithmatex">\(W_o\)</span> ja <span class="arithmatex">\(W_c\)</span>. <sup id="fnref14:ldl"><a class="footnote-ref" href="#fn:ldl">1</a></sup> <sup id="fnref15:geronpytorch"><a class="footnote-ref" href="#fn:geronpytorch">3</a></sup></li>
<li><span class="arithmatex">\(h\)</span> on hidden state vektori, jonka pituus on <span class="arithmatex">\(d_h\)</span>. <sup id="fnref15:ldl"><a class="footnote-ref" href="#fn:ldl">1</a></sup> <sup id="fnref16:geronpytorch"><a class="footnote-ref" href="#fn:geronpytorch">3</a></sup></li>
<li><span class="arithmatex">\(c\)</span> on cell state vektori, joka toimii LSTM:n muistina, ja sen pituus on jaettu <span class="arithmatex">\(h\)</span>:n kanssa, eli <span class="arithmatex">\(d_h\)</span>. <sup id="fnref16:ldl"><a class="footnote-ref" href="#fn:ldl">1</a></sup> <sup id="fnref17:geronpytorch"><a class="footnote-ref" href="#fn:geronpytorch">3</a></sup></li>
<li><span class="arithmatex">\(x\)</span> on syötevektori, jonka pituus on <span class="arithmatex">\(d_x\)</span> (embedding_size).<ul>
<li>On mahdollista tehdä <code>concat(x, h)</code> ja käyttää tätä yhdistettyä vektoria syötteenä porttien laskentaan, jolloin painomatriisit <span class="arithmatex">\(W_f\)</span>, <span class="arithmatex">\(W_i\)</span>, <span class="arithmatex">\(W_o\)</span> ja <span class="arithmatex">\(W_c\)</span> olisivat muotoa <span class="arithmatex">\((d_h + d_x) \times d_h\)</span>. <sup id="fnref18:ldl"><a class="footnote-ref" href="#fn:ldl">1</a></sup></li>
</ul>
</li>
<li>Muistin tarve skaalautuu <span class="arithmatex">\(d_h\)</span> ja embedding-koon, <span class="arithmatex">\(d_x\)</span>, mukaan.</li>
</ul>
<p>Aiheeseen liittyviä kuvaajia ja selostusta löytyy netistä reilusti. Yksi hyvä lähde on vastavirta-algoritmeista tuttu Christopher Olah. Hänen blogistaan löydät kenties tyypillisimmän tavan abstrahoida LSTM:n <sup id="fnref:colahblog"><a class="footnote-ref" href="#fn:colahblog">8</a></sup> – saman, jota Géron käyttää kirjassaan – merkinnästä <a href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/">Understanding LSTM Networks</a></p>
<p>LSTM on käytetyin RNN-variantti: sen hyödyt ovat pitkälti samat kuin RNN:n, mutta <em>cell state</em> ja <em>gating</em> -mekanismien ansiosta se kykenee paremmin säilyttämään tietoa pitkissä sekvensseissä. <sup id="fnref:towardds"><a class="footnote-ref" href="#fn:towardds">9</a></sup></p>
<div class="admonition info">
<p class="admonition-title">Matemaattiset kaavat</p>
<div class="arithmatex">\[
\begin{align}
f^{(t)} &amp;= \sigma( W_f [ h^{(t-1)}, x^{(t)} ] + b_f ) \tag{1} \\
i^{(t)} &amp;= \sigma( W_i [ h^{(t-1)}, x^{(t)} ] + b_i ) \tag{2} \\
\tilde{C}^{(t)} &amp;= \tanh ( W_c [ h^{(t-1)}, x^{(t)} ] + b_c ) \tag{3} \\
C^{(t)} &amp;= f^{(t)} * C^{(t-1)} + i^{(t)} * \tilde{C}^{(t)} \tag{4} \\
o^{(t)} &amp;= \sigma( W_o [ h^{(t-1)}, x^{(t)} ] + b_o ) \tag{5} \\
h^{(t)} &amp;= o^{(t)} * \tanh ( C^{(t)} ) \tag{6}
\end{align}
\]</div>
<p>Yllä olevat kaavat ovat kirjasta Learning Deep Learning <sup id="fnref17:ldl"><a class="footnote-ref" href="#fn:ldl">1</a></sup>. Löydät Géronin kirjasta vastaavat kaavat, mutta niissä on ei ole käytetty <code>concatenate</code>-tekniikkaa, joten painomatriiseja on tuplamäärä <sup id="fnref18:geronpytorch"><a class="footnote-ref" href="#fn:geronpytorch">3</a></sup>. Kaavojen numerot vastaavat seuraavia vaiheita, ja ne on merkitty yllä olevaan kuvaan (Kuva 6).</p>
</div>
<h3 id="gru">GRU</h3>
<p>Kyunghyun Cho ja kollegat esittelivät GRU-arkkitehtuurin 2014 <sup id="fnref:gru"><a class="footnote-ref" href="#fn:gru">2</a></sup>. GRU on käytännössä yksinkertaistettu LSTM, joka yksinkertaisuudestaan huolimatta suoriutuu LSTM:ään verrattavalla tavalla <sup id="fnref10:geronpytorch"><a class="footnote-ref" href="#fn:geronpytorch">3</a></sup>. Alkuperäinen Cho:n ja kumppaneiden julkaisu ei sisällä lyhennettä <em>GRU</em> laisinkaan. Julkaisun aihe on seq2seq Encoder-Decoder -arkkitehtuuri, mutta ikään kuin kylkiäisenä esitellään tämä uusi yksinkertaistettu LSTM-variaatio:</p>
<blockquote>
<p>"In addition to a novel model architecture, we also
propose a new type of hidden unit (f in Eq. (1))
that has been motivated by the LSTM unit but is
much simpler to compute and implement"</p>
<p>— Cho et. al. <sup id="fnref3:gru"><a class="footnote-ref" href="#fn:gru">2</a></sup></p>
</blockquote>
<h2 id="tehtavat">Tehtävät</h2>
<div class="admonition question">
<p class="admonition-title">Tehtävä: RNN videoiden avulla</p>
<p>Jos yllä oleva selostus ei selkeyttänyt aihetta, etsi myös muita lähteitä. </p>
<ul>
<li>Yksi ehdotus on Lex Fridmanin <a href="https://youtu.be/nFTQ7kHQWtc?t=2164">MIT 6.S094: Recurrent Neural Networks for Steering Through Time</a>-luento, joka on saatavilla YouTubessa. Videon alku on kertausta vastavirta-algoritmista, joten voit hypätä suoraan 36:04 kohtaan, josta RNN:t alkavat. Erityisesti videon lopun Application-osiot ovat varsin korvaamattoman tasokasta sisältöä.</li>
<li>Myös StatQuestin soittolista <a href="https://youtube.com/playlist?list=PLblh5JKOoLUIxGDQs4LFFD--41Vzf-ME1&amp;si=FBwTC2HDHZhTr6Nw">Neural Networks / Deep Learning</a> sisältää useita videoita, joissa käsitellään esim.:<ul>
<li>RNN</li>
<li>LSTM</li>
<li>Word2Vec (viime viikon aihe)</li>
<li>Seq2Seq Encoder-Decoder</li>
<li>Attention</li>
</ul>
</li>
</ul>
</div>
<div class="admonition question">
<p class="admonition-title">Tehtävä: Sukunimien luokittelu Pt.1</p>
<p>Avaa Marimo Notebook <code>710_...py</code> ja tutustu koodiin. Kyseessä on <a href="https://docs.pytorch.org/tutorials/intermediate/char_rnn_classification_tutorial.html">NLP From Scratch: Classifying Names with a Character-Level RNN</a>-tutoriaali PyTorchin dokumentaatiosta, joka on käännetty Marimo-malliin sopivaksi. Suorita koodi ja tarkastele tuloksia.</p>
<p>Mallin koulutus vei Macbook Pro:lla MPS:ää käyttäen 12 minuuttia. CUDA-PC:llä koulutus meni 2 minuutissa.</p>
</div>
<div class="admonition question">
<p class="admonition-title">Tehtävä: Sukunimien luokittelu Pt.2</p>
<p>Palaa aiempaan <code>710</code>-alkuiseen Notebookiin. Kouluta malli uusiksi siten, että se ymmärtää myös suomalaisia sukunimiä. Käytä tässä apuna Avoidata.fi-palvelusta löytyvää Digi- ja väestöviraston julkaisemaa datasettiä <a href="https://avoindata.suomi.fi/data/fi/dataset/none">Väestötietojärjestelmän suomalaisten nimiaineistot</a> (CC BY). Tee siis seuraavat:</p>
<ol>
<li>Lataa Excel-tiedosto</li>
<li>Valitse kaikki sukunimet, joita on 700 tai yli</li>
<li>Kopioi valitut leikepöydälle</li>
<li>Liitä tiedostoon <code>data/names/Finnish.txt</code></li>
</ol>
<p>Nyt sinulle pitäisi olla datasetissä uusi label <code>Finnish</code>, joka sisältää toista tuhatta suomenkielistä sukunimeä. Kouluta malli uudestaan, kenties eri tiedostonimellä, ja tarkastele tuloksia. Tunnistaako se sinut oikein? Mahdoitko olla training- vai test-datassa vai et kummassakaan?</p>
</div>
<div class="admonition question">
<p class="admonition-title">Tehtävä: Sukunimien generointi</p>
<p>Tutustu <code>711_char_rnn_generation_tutorial.py</code>-tiedostoon, joka on Marimo-muotoon käännetty versio <a href="https://docs.pytorch.org/tutorials/intermediate/char_rnn_generation_tutorial.html">NLP From Scratch: Generating Names with a Character-Level RNN</a>-tutoriaalista. Tässä tutoriaalissa käytetään samaa dataa kuin edellisessä, mutta nyt mallin tavoite on generoida uusia sukunimiä eri kielille. Tutustu Notebookin koodiin ja selvitä, kuinka malli koulutetaan ja kuinka sitä kutsutaan. Muista, että tarkoituksena ei ole pelkästään ajaa koodia, vaan ymmärtää, miten se toimii. Tee tämä ymmärrys näkyväksi oppimispäiväkirjassasi.</p>
<p>Huomaa, että dataset on sama kuin edellisessä tehtävässä, joten sinun äskettäin lisäämäsi suomalaiset sukunimet ovat nyt mukana myös tässä mallissa. Generointiin voit käyttää Notebookissa olevia valmiita funktioita:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">samples</span><span class="p">(</span><span class="s1">&#39;Finnish&#39;</span><span class="p">,</span> <span class="s1">&#39;ABCDEFGHIJKL&#39;</span><span class="p">)</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">Artinen</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">Bartanen</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="n">Charinen</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="n">Dantalak</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="n">Eantara</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="n">Fintanen</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="c1"># + ???</span>
</span></code></pre></div>
<p>Malli kouluttautui opettajan Macbook Pro:lla noin 1 minuutissa.</p>
</div>
<div class="admonition question">
<p class="admonition-title">Tehtävä: Konekäännös (Seq2Seq + Attention)</p>
<p>Tutustu <code>712_seq2seq_translation_tutorial.py</code>-tiedostoon, joka on Marimo-muotoon käännetty versio <a href="https://pytorch.org/tutorials/intermediate/seq2seq_translation_tutorial.html">NLP From Scratch: Translation with a Sequence to Sequence Network and Attention</a>-tutoriaalista. Tässä tehtävässä rakennetaan neuroverkko, joka kääntää ranskaa englanniksi.</p>
<p>Malli hyödyntää <a href="https://arxiv.org/abs/1409.3215">Sequence to Sequence</a> (seq2seq) -arkkitehtuuria, jossa kaksi RNN-verkkoa toimivat yhdessä: toinen enkoodaa syötteen ja toinen dekoodaa sen käännökseksi. Tämän lisäksi mallissa käytetään <a href="https://arxiv.org/abs/1409.0473">Attention-mekanismia</a>, joka antaa dekooderin keskittyä syötteen tiettyihin osiin käännöstä generoidessaan. Attention käydään läpi tarkemmin seuraavassa <a href="../transformers/">Transformers</a>-osiossa, joten voit palata siltä osin tähän Notebookiin myöhemmin.</p>
<p>Tehtävänäsi on suorittaa Notebook, tutustua koodiin ja varmistaa, että ymmärrät Attention-mekanismin perusperiaatteen.</p>
<p>Malli kouluttautui opettajan Macbook Pro:lla noin 8 minuutissa.</p>
</div>
<div class="admonition question">
<p class="admonition-title">Tehtävä: Kielimalli ja sanaulottuvuudet</p>
<p>Tutustu <code>713_nvidia_language_model_embedding.py</code>-tiedostoon. Tämä on muokattu versio NVIDIA:n Learning Deep Learning -kirjan (ja videosarjan) esimerkistä. Tehtävässä koulutetaan LSTM-pohjainen kielimalli, joka ennustaa seuraavaa sanaa annetun kontekstin perusteella. Samalla malli oppii sanaulottuvuudet (word embeddings).</p>
<p>Tehtävänäsi on suorittaa Notebook ja tutustua koodiin. Kiinnitä erityisesti huomiota siihen, miten mallin oppimia embedding-vektoreita voidaan lopuksi hyödyntää etsimällä sanoille merkityksellisesti lähimpiä naapureita vektoriavaruudessa.</p>
<p>Malli kouluttautui opettajan Macbook Pro:lla noin 4 minuutissa CPU:lla ja 50 sekunnissa MPS:llä.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Huomaa, että tämä ei siis ole encoder-decoder -malli vaan iteratiivisesti ajettu seq2vec. Jos haluat tutustua Magnus Ekmanin versioon encoder-decoder -arkkitehtuurista, joka on toteutettu LSTM:llä, voit tutustua LDL:n repositoriosta löytyvään <a href="https://github.com/NVDLI/LDL/blob/main/pt_framework/v7_3_neural_machine_translation.ipynb">v7_3_neural_machine_translation.ipyn</a> Jupyter Notebookiin. Malli on vastaava kuin <code>712_seq2seq_translation_tutorial.py</code>-tiedostossa, mutta kohtalaisen tiiviillä koodilla toteutettu.</p>
</div>
</div>
<h2 id="lahteet">Lähteet</h2>
<div class="footnote">
<hr />
<ol>
<li id="fn:ldl">
<p>Ekman, M. <em>Learning Deep Learning: Theory and Practice of Neural Networks, Computer Vision, NLP, and Transformers using TensorFlow</em>. Addison-Wesley. 2025.&#160;<a class="footnote-backref" href="#fnref:ldl" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:ldl" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref3:ldl" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref4:ldl" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref5:ldl" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref6:ldl" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref7:ldl" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref8:ldl" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref9:ldl" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref10:ldl" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref11:ldl" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref12:ldl" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref13:ldl" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref14:ldl" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref15:ldl" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref16:ldl" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref17:ldl" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref18:ldl" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:gru">
<p>Cho, K., van Merriënboer, B., Gulcehre, C., Bahdanau, D., Bougares, F., Schwenk, H., &amp; Bengio, Y. <em>Learning phrase representations using RNN encoder-decoder for statistical machine translation</em>. 2014. https://arxiv.org/abs/1406.1078&#160;<a class="footnote-backref" href="#fnref:gru" title="Jump back to footnote 2 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:gru" title="Jump back to footnote 2 in the text">&#8617;</a><a class="footnote-backref" href="#fnref3:gru" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:geronpytorch">
<p>Géron, A. <em>Hands-On Machine Learning with Scikit-Learn and PyTorch</em>. O'Reilly. 2025.&#160;<a class="footnote-backref" href="#fnref:geronpytorch" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:geronpytorch" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref3:geronpytorch" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref4:geronpytorch" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref5:geronpytorch" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref6:geronpytorch" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref7:geronpytorch" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref8:geronpytorch" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref9:geronpytorch" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref10:geronpytorch" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref11:geronpytorch" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref12:geronpytorch" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref13:geronpytorch" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref14:geronpytorch" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref15:geronpytorch" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref16:geronpytorch" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref17:geronpytorch" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref18:geronpytorch" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:llmfromscratch">
<p>Raschka, S. <em>Build a Large Language Model (From Scratch)</em>. Manning. 2024.&#160;<a class="footnote-backref" href="#fnref:llmfromscratch" title="Jump back to footnote 4 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:llmfromscratch" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:karpathy">
<p>Karpathy, A. "The Unreasonable Effectiveness of Recurrent Neural Networks". 2015. https://karpathy.github.io/2015/05/21/rnn-effectiveness/&#160;<a class="footnote-backref" href="#fnref:karpathy" title="Jump back to footnote 5 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:karpathy" title="Jump back to footnote 5 in the text">&#8617;</a><a class="footnote-backref" href="#fnref3:karpathy" title="Jump back to footnote 5 in the text">&#8617;</a><a class="footnote-backref" href="#fnref4:karpathy" title="Jump back to footnote 5 in the text">&#8617;</a><a class="footnote-backref" href="#fnref5:karpathy" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
<li id="fn:lstm">
<p>Hochreiter, S., &amp; Schmidhuber, J. (1997). Long short-term memory. Neural computation. 1997. https://deeplearning.cs.cmu.edu/S23/document/readings/LSTM.pdf&#160;<a class="footnote-backref" href="#fnref:lstm" title="Jump back to footnote 6 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:lstm" title="Jump back to footnote 6 in the text">&#8617;</a><a class="footnote-backref" href="#fnref3:lstm" title="Jump back to footnote 6 in the text">&#8617;</a><a class="footnote-backref" href="#fnref4:lstm" title="Jump back to footnote 6 in the text">&#8617;</a></p>
</li>
<li id="fn:lstm-forget">
<p>Gers, F. A., Schmidhuber, J., &amp; Cummins, F. <em>Learning to forget: Continual prediction with LSTM. Neural computation</em>. 2000. doi: 10.1049/cp:19991218&#160;<a class="footnote-backref" href="#fnref:lstm-forget" title="Jump back to footnote 7 in the text">&#8617;</a></p>
</li>
<li id="fn:colahblog">
<p>Olah, C. <em>Understanding LSTM Networks</em>. 2015. https://colah.github.io/posts/2015-08-Understanding-LSTMs/&#160;<a class="footnote-backref" href="#fnref:colahblog" title="Jump back to footnote 8 in the text">&#8617;</a></p>
</li>
<li id="fn:towardds">
<p>Dancker, J. <em>A Brief Introduction to Recurrent Neural Networks</em>. Towards Data Science. 2022. https://towardsdatascience.com/a-brief-introduction-to-recurrent-neural-networks-638f64a61ff4/&#160;<a class="footnote-backref" href="#fnref:towardds" title="Jump back to footnote 9 in the text">&#8617;</a></p>
</li>
</ol>
</div>







  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2026 <a href="https://www.kamk.fi">Kajaanin Ammattikorkeakoulu Oy</a>. 
Licenced under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">BY-NC-SA 4.0</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["content.code.copy", "content.code.annotate", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Kopioitu leikep\u00f6yd\u00e4lle", "clipboard.copy": "Kopioi leikep\u00f6yd\u00e4lle", "search.result.more.one": "1 lis\u00e4\u00e4 t\u00e4ll\u00e4 sivulla", "search.result.more.other": "# lis\u00e4\u00e4 t\u00e4ll\u00e4 sivulla", "search.result.none": "Ei t\u00e4sm\u00e4\u00e4vi\u00e4 dokumentteja", "search.result.one": "1 t\u00e4sm\u00e4\u00e4v\u00e4 dokumentti", "search.result.other": "# t\u00e4sm\u00e4\u00e4v\u00e4\u00e4 dokumenttia", "search.result.placeholder": "Kirjoita aloittaaksesi haun", "search.result.term.missing": "Puuttuu", "select.version": "Valitse versio"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>