
<!doctype html>
<html lang="fi" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../pretrained/">
      
      
        <link rel="next" href="../../kieli/nlp/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.2">
    
    
      
        <title>Siirtovaikutus - Syväoppiminen I</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#siirtovaikutus" class="md-skip">
          Hyppää sisältöön
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Ylätunniste">
    <a href="../.." title="Syväoppiminen I" class="md-header__button md-logo" aria-label="Syväoppiminen I" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Syväoppiminen I
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Siirtovaikutus
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Hae" placeholder="Hae" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Haku">
        
        <button type="reset" class="md-search__icon md-icon" title="Tyhjää" aria-label="Tyhjää" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Aloitetaan hakua
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigaatio" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Syväoppiminen I" class="md-nav__button md-logo" aria-label="Syväoppiminen I" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Syväoppiminen I
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tervetuloa kurssille
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    1. Neuroverkot
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    1. Neuroverkot
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroverkot/neuroverkot_101/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Neuroverkot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neuroverkot/syvaoppiminen_FC/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Syvät neuroverkot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    2. Tensorit
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    2. Tensorit
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tensorit/vektorointi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Vektorointi
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tensorit/pytorch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PyTorch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    3. Vastavirta
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    3. Vastavirta
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vastavirta/backpropagation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Vastavirta (Backprop)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    4. Mallinnus
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    4. Mallinnus
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mallinnus/yleiskatsaus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Yleiskatsaus
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mallinnus/datanlataus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Datan lataus
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mallinnus/kaytannot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kouluttamisen käytännöt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    5. Konvoluutio
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    5. Konvoluutio
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../konvoluutio/cnn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Konvoluutioverkot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    6. Siirtovaikutus
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    6. Siirtovaikutus
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pretrained/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Koulutetun mallin käyttö
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Siirtovaikutus
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Siirtovaikutus
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Sisällysluettelo">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Sisällysluettelo
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#termi" class="md-nav__link">
    <span class="md-ellipsis">
      
        Termi
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Termi">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pedagoginen-tausta" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pedagoginen tausta
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#koneoppiminen" class="md-nav__link">
    <span class="md-ellipsis">
      
        Koneoppiminen
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kaytannossa" class="md-nav__link">
    <span class="md-ellipsis">
      
        Käytännössä
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Käytännössä">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pelkat-piirteet-ulos" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pelkät piirteet ulos
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loppuun-liitetty-luokittelija" class="md-nav__link">
    <span class="md-ellipsis">
      
        Loppuun liitetty luokittelija
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partial-fine-tuning" class="md-nav__link">
    <span class="md-ellipsis">
      
        Partial Fine-Tuning
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toolkit" class="md-nav__link">
    <span class="md-ellipsis">
      
        Toolkit
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tehtavat" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tehtävät
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lahteet" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lähteet
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    7. Kieli
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    7. Kieli
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kieli/nlp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Luonnollinen kieli
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kieli/rnn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RNN ja jälkeläiset
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kieli/transformers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transformers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    8. Aikasarjat
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    8. Aikasarjat
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aikasarjat/ideat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Aikasarjat
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercises/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tehtäväkooste
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Sisällysluettelo">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Sisällysluettelo
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#termi" class="md-nav__link">
    <span class="md-ellipsis">
      
        Termi
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Termi">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pedagoginen-tausta" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pedagoginen tausta
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#koneoppiminen" class="md-nav__link">
    <span class="md-ellipsis">
      
        Koneoppiminen
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kaytannossa" class="md-nav__link">
    <span class="md-ellipsis">
      
        Käytännössä
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Käytännössä">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pelkat-piirteet-ulos" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pelkät piirteet ulos
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loppuun-liitetty-luokittelija" class="md-nav__link">
    <span class="md-ellipsis">
      
        Loppuun liitetty luokittelija
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partial-fine-tuning" class="md-nav__link">
    <span class="md-ellipsis">
      
        Partial Fine-Tuning
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#toolkit" class="md-nav__link">
    <span class="md-ellipsis">
      
        Toolkit
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tehtavat" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tehtävät
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lahteet" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lähteet
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="siirtovaikutus">Siirtovaikutus</h1>
<h2 id="termi">Termi</h2>
<h3 id="pedagoginen-tausta">Pedagoginen tausta</h3>
<p>Siirtovaikutus (engl. transfer learning) tarkoittaa aiemmin hankitun tieton tai taidon hyödyntämistä uudessa, usein suhteellisen samankaltaisessa tehtävässä. On hyvä huomata, että tämä termi ei ole alkujaan koneoppimisen kontekstissa syntynyt. Termi on kotoisin (kasvatus)psykologiasta. Pedagogiaa opiskelleet ovat lähes väistämättä törmänneet Thorndiken ja Woodworthin löydöksiin 1900-luvun alusta, jossa he osoittivat, että harjoittelun vaikutus yhdellä osa-alueella voi siirtyä toiseen osa-alueeseen, mikäli molemmissa on yhteisiä elementtejä. Kuten he kirjoittavat:</p>
<blockquote>
<p>"The general consideration of the cases of retention or of loss of practice effect seems to make it
likely that spread of practice occurs only where identical elements are concerned in the
influencing and influenced function." <sup id="fnref:influence"><a class="footnote-ref" href="#fn:influence">1</a></sup></p>
</blockquote>
<p>Oppiiko tammea osaava lapsi nopeammin shakin kuin ei-tammea osaava lapsi? Entä oppiiko shakkia taitava lapsia vertaisiaan nopeammin pelaamaan Carcassonnea? Nykyiset oppimiskäsitykset kasvatustieteissä ja kognitiotieteissä ovat epäilemättä kehittyneet Thorndiken ja Woodworthin ajoista, mutta koska tämän kurssin konteksti on koneoppiminen, emme syvenny pedagogisiin teorioihin enempää. Termin käyttö koneoppimisen yhteydessä on kuitenkin hyvin osuvaa, koska koneoppimisen siirtovaikutus perustuu pitkälti samankaltaiseen periaatteeseen. Siirtovaikutus ei ole <em>hopealuoti</em>, joka ratkaisee kaikki ongelmat aina, mutta samankaltaisen tehtävän äärellä se voi tarjota nopean ja tehokkaan tavan saavuttaa hyviä tuloksia. UKK-instituutin <a href="https://tervekoululainen.fi/ylakoulu/liikuntataidot/siirtovaikutus/">Siirtovaikutus</a>-artikkeli on kirjoitettu liikunnan näkökulmasta, ja siinä kyseenalaistetaan jo otsikkotasolla: "Taidot siirtyvät vai siirtyvätkö?" <sup id="fnref:tervekoululainen"><a class="footnote-ref" href="#fn:tervekoululainen">2</a></sup>.</p>
<h3 id="koneoppiminen">Koneoppiminen</h3>
<p>Koneoppimisen kontekstissa termi on syntynyt 1970-luvun aikoihin. Bozinovski koostaa historiallista taustaa artikkelissaan <sup id="fnref:reminder"><a class="footnote-ref" href="#fn:reminder">3</a></sup>, johon kannattaa tutustua ainakin pintapuoleisesti.</p>
<blockquote>
<p>"Basically it is using a pre-trained neural network
(trained for Task1) for achieving shorter training time
(positive transfer learning) in learning Task2." <sup id="fnref2:reminder"><a class="footnote-ref" href="#fn:reminder">3</a></sup></p>
</blockquote>
<p>On tärkeää erotta seuraavat termit:</p>
<ul>
<li><strong>Siirtovaikutus (Transfer Learning)</strong>: Yleinen käsite eli kattotermi. Aiemmin opitun tiedon hyödyntämiseen uudessa tehtävässä <sup id="fnref:aiengineering"><a class="footnote-ref" href="#fn:aiengineering">4</a></sup>.<ul>
<li><strong>Hienosäätö (Fine-tuning)</strong>: Siirtovaikutuksen erityinen muoto, jossa esikoulutettua mallia säädetään uudelleen uudessa tehtävässä, usein pienemmällä oppimisnopeudella ja pienemmällä datamäärällä <sup id="fnref2:aiengineering"><a class="footnote-ref" href="#fn:aiengineering">4</a></sup>.</li>
<li><strong>Piirrepohjainen siirto (Feature-based transfer)</strong>: Siirtovaikutuksen muoto, jossa esikoulutetun mallin piirteitä käytetään suoraan uudessa tehtävässä ilman mallin painojen hienosäätöä <sup id="fnref3:aiengineering"><a class="footnote-ref" href="#fn:aiengineering">4</a></sup>.</li>
</ul>
</li>
</ul>
<p>Tällä kurssilla käsittelemme erityisesti <em>piirrepohjaista siirtoa</em>. Toivon mukaan muistat konvoluutioverkoista sen, että ne oppivat matalammilla tasoilla yleisiä piirteitä, kuten reunoja ja muotoja, joista muodostetaan piirrevektori, jota käytetään luokitteluun. Tämä korvaa piirrevektorin käsin suunnitellut piirteet, joita käytettiin ennen syvien verkkojen aikakautta. Koska matalammat tasot oppivat yleisiä piirteitä, niitä voidaan hyödyntää uudessa tehtävässä, joka on samankaltainen kuin alkuperäinen tehtävä. Esimerkiksi esikoulutettu verkko, joka on koulutettu tunnistamaan esineitä ImageNet-datasetillä, voi olla hyvä lähtökohta hienosäätöön (fine-tuning) esimerkiksi lääketieteellisten kuvien luokittelussa. Tällöin verkon matalammat tasot säilytetään, ja vain mallin korkein taso, <em>fully connected layer</em>, eli varsinainen luokittelija, korvataan uudella.</p>
<p>Erityisesti kielimallien kontekstissa hienosäätö on yleinen käytäntö, jossa esikoulutettu malli, kuten GPT tai BERT, säädetään uudelleen tiettyyn tehtävään, kuten tekstin luokitteluun tai kysymys-vastaus -tehtäviin. Pohjalla on usein ohjaamatonta oppimista, tai tarkemmin <em>self-supervised learning</em> -lähestymistapa, jossa malli oppii kielen rakenteita ja merkityksiä suuresta tekstikorpuksesta ilman oikeaa vastausta (eli <em>label</em> puuttuu). Tämän jälkeen malli hienosäädetään pienemmällä, tehtäväkohtaisella datalla. Tähän tutustutaan kenties tällä kurssilla pintapuolisesti, mutta syvällisemmin myöhemmillä kursseilla.</p>
<p>Jos päädyt suorittamaan hienosäätöä, tarvitset enemmän muistia kuin pelkän loppuun liitetyn luokittelijan kanssa. Vastavirta-algoritmi tarvitsee tällöin kaikkien ei-lukittujen kerrosten painot, aktivoinnit ja gradientit. Tässä tulee äkkiä kotikäyttöisen GPU:n rajat vastaan. Tosin tyypillisesti aivan kaikkia kerroksia ei ylipäätänsä hienosäädetä: Watson ja Chollet suosittelevat <mark>partial fine-tuning</mark> -lähestymistapaa, jossa vain verkon korkeimmat kerrokset säädetään uudelleen, ja matalammat kerrokset pidetään lukittuina. Tärkeimmiksi syiksi he nostavat, että (1) mallin alimmat kerrokset sisältävät geneerisiä muotoja ja piirteitä, jotka ovat kontekstista toiseen päteviä, ja (2) ylimääräisten painojen sisällyttäminen kouluttamiseen nostaa ylisovittamisen riskiä. <sup id="fnref:dlwithpython"><a class="footnote-ref" href="#fn:dlwithpython">5</a></sup></p>
<h2 id="kaytannossa">Käytännössä</h2>
<p>Esikouluttamisen mallin käyttö piirteiden muodostamiseen on varsin helppoa. Tällöin käytännössä leikkaisit koko verkosta pois viimeisen luokittelukerroksen, ja käyttäisit jäljelle jäänyttä verkkoa piirteiden muodostamiseen. Otetaan esimerkiksi ResNet50, jossa 50 viittaa 50x painokerrosten määrään. Myös tämä malli on koulutettu aiemmin tutuksi tulleella ImageNet-datasetillä.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">conv_base</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">resnet50</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="s1">&#39;IMAGENET1K_V1&#39;</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="c1"># Tämä tulostaisi 49x painokerrosta - viimeisin on luokittelukerros nimeltään &quot;fc.weight&quot;</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">conv_base</span><span class="o">.</span><span class="n">named_parameters</span><span class="p">()</span> <span class="k">if</span> <span class="s2">&quot;conv&quot;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">]</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="c1"># Meitä kiinnostaa enemmän verkon rakenne, joten kurkkastaan sen lapsia:</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">conv_base</span><span class="o">.</span><span class="n">named_children</span><span class="p">()]</span>
</span></code></pre></div>
<div class="language-text highlight"><span class="filename">Output</span><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>[
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>  &quot;conv1&quot;,
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>  &quot;bn1&quot;,
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>  &quot;relu&quot;,
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>  &quot;maxpool&quot;,
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>  &quot;layer1&quot;,
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>  &quot;layer2&quot;,
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>  &quot;layer3&quot;,
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>  &quot;layer4&quot;,
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>  &quot;avgpool&quot;,
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>  &quot;fc&quot;
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>]
</span></code></pre></div>
<p>Jos tutkimme pelkkää viimeistä kerrosta, sen rakenne on seuraava:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">conv_base</span><span class="o">.</span><span class="n">fc</span>
</span></code></pre></div>
<div class="language-text highlight"><span class="filename">Output</span><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>Linear(in_features=2048, out_features=1000, bias=True)
</span></code></pre></div>
<h3 id="pelkat-piirteet-ulos">Pelkät piirteet ulos</h3>
<p>Jos haluaisimme tallentaa piirteet ulos, voisimme rakentaa uuden mallin, joka ottaa syötteenä kuvan ja palauttaa piirrevektorin:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="k">class</span><span class="w"> </span><span class="nc">FeatureExtractor</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_model</span><span class="p">):</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>        <span class="nb">super</span><span class="p">(</span><span class="n">FeatureExtractor</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>        <span class="c1"># Kopioi kaikki kerrokset paitsi viimeisen luokittelukerroksen</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">features</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="n">base_model</span><span class="o">.</span><span class="n">children</span><span class="p">())[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">features</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Litistä piirrevektori</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>        <span class="k">return</span> <span class="n">x</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="n">feature_extractor</span> <span class="o">=</span> <span class="n">FeatureExtractor</span><span class="p">(</span><span class="n">conv_base</span><span class="p">)</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="c1"># Usage</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="n">dummy_input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="n">features</span> <span class="o">=</span> <span class="n">feature_extractor</span><span class="p">(</span><span class="n">dummy_input</span><span class="p">)</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="nb">print</span><span class="p">(</span><span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Should be (2, 2048)</span>
</span></code></pre></div>
<p>Nämä piirteet voi luonnollisesti tallentaa tiedostoon ja siten käyttää myöhemmin vaikkapa Logistic Regression -luokittelijan kouluttamiseen.</p>
<h3 id="loppuun-liitetty-luokittelija">Loppuun liitetty luokittelija</h3>
<p>Jos haluaisimme rakentaa mallin, jossa on loppuun liitetty luokittelija, voisimme tehdä sen seuraavasti:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">new_head</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="n">num_classes</span><span class="p">)</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="n">conv_base</span><span class="o">.</span><span class="n">fc</span> <span class="o">=</span> <span class="n">new_head</span>
</span></code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Huomaa, että voimme sisällyttää luokittelijaan myös piilotetun kerroksen, jolloin rakenne olisi hieman monimutkaisempi, kuten:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">new_head</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>    <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="mi">512</span><span class="p">),</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>    <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>    <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">out_features</span><span class="o">=</span><span class="n">num_classes</span><span class="p">)</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="p">)</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="n">conv_base</span><span class="o">.</span><span class="n">fc</span> <span class="o">=</span> <span class="n">new_head</span>
</span></code></pre></div>
</div>
<p>Kun edellinen pää on korvattu uudella, meidän tulee kouluttaa vain tämä uusi pää. Tämä onnistuu asettamalla muiden kerrosten <code>requires_grad</code>-attribuutin arvoksi <code>False</code>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">conv_base</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>    <span class="n">param</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="c1"># Uuden fully connected -kerroksen gradientit pitää sen sijaan laskea</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">conv_base</span><span class="o">.</span><span class="n">fc</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>    <span class="n">param</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">True</span>
</span></code></pre></div>
<p>Jatkossa malli koulutetaan aivan kuten kaikki aiemmatkin kurssin mallit: sinun tulee kirjoittaa <em>training loop</em>, jossa suoritetaan eteenpäin- ja taaksepäin-syöttö, sekä optimointivaihe.</p>
<h3 id="partial-fine-tuning">Partial Fine-Tuning</h3>
<p>Jos haluaisimme suorittaa osittaista hienosäätöä, voisimme lukita vain osan verkon kerroksista. Esimerkiksi voisimme lukita kaikki kerrokset ennen <code>layer4</code>-kerrosta:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">conv_base</span><span class="o">.</span><span class="n">named_parameters</span><span class="p">():</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>    <span class="n">parameter</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>    <span class="k">if</span> <span class="s1">&#39;layer3.5.bn3.bias&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>        <span class="k">break</span>
</span></code></pre></div>
<p>On myös mahdollista tehdä tämä vaiheittain, eli kouluttaa <span class="arithmatex">\(n\)</span> epookin ajan vain luokittelijaa, ja sen jälkeen avata lisää kerroksia hienosäätöä varten.</p>
<h3 id="toolkit">Toolkit</h3>
<p>Ajoittain löydät myös valmiita työkaluja, jotka helpottavat siirtovaikutuksen hyödyntämistä. Esimerkiksi <a href="https://huggingface.co/ResembleAI/chatterbox-turbo">hf:ResembleAI/chatterbox-turbo</a> on esikoulutettu Text-to-Speech-malli, jonka voi ladata ja hienosäätää helposti Hugging Facen <code>transformers</code>-kirjaston avulla. Online-yhteisö, tai tarkemmin kehittäjä Gokhan Eraslan, on julkaissut työkalun, jolla hienosäätö onnistuu helposti omalla datalla käyttöohjeineen: <a href="https://github.com/gokhaneraslan/chatterbox-finetuning">gh:gokhaneraslan/chatterbox-finetuning</a>.</p>
<h2 id="tehtavat">Tehtävät</h2>
<div class="admonition question">
<p class="admonition-title">Tehtävä: Dogs vs. Cats siirtovaikutus</p>
<p>Aja <code>610_dogs_vs_cats.py</code> Marimo Notebook.</p>
<p>Kuinka korkealle sijoittautuisit alkuperäisessä <a href="https://www.kaggle.com/competitions/dogs-vs-cats/leaderboard">Kaggle: Dogs vs. Cats</a> -kilpailussa? Adrian Rosebrock esitteli muinoin kirjassaan, kuinka AlexNet:n kouluttamalla kokonaan ko. datasetillä saavutti noin 93 % tarkkuuden, mutta käyttämällä piirrepohjaista siirtovaikutusta (feature-based transfer learning) hän saavutti 98.69 % tarkkuuden, jolla olisi päässyt kilpailussa hopeasijalle! Mallina hänellä oli ResNet50, jolla hän generoi piirrevektorit, joita hän käytti Logistic Regression -luokittelijan syötteenä. <sup id="fnref:dl4cv"><a class="footnote-ref" href="#fn:dl4cv">6</a></sup></p>
<p>Malli kouluttautui opettajan Macbookilla noin 8 minuuttia (5 epookkia).</p>
</div>
<div class="admonition question">
<p class="admonition-title">Tehtävä: RPS-datasetin luonti webcamilla</p>
<p>Laurence Monorey, joka on mm. kirjan <em>AI and ML for Coders in PyTorch</em> kirjoittaja, jakaa verkkosivuillaan datasettiä <a href="https://laurencemoroney.com/datasets.html">Rock Paper Scissors</a>, joka sisältää kuvia käsimerkeistä kivi, paperi ja sakset. Linkit ovat vanhoja, mutta alkuperäinen datasetti on yhä ladattavissa <a href="https://storage.googleapis.com/learning-datasets/rps.zip">storage.googleapis.com/learning-datasets/rps.zip</a>-osoitteesta. Setissä on 840 kuvaa per luokka.</p>
<p>Voisimme käyttää tätä CGI-generoitua datasettiä, mutta on paljon parmepaa oppimista kasata oma datasetti! Meillä kaikilla on jokin webcam, joten käyttäkäämme sitä. Tähän löytyy valmis toteutus skriptistä <code>611_rps_generator.py</code>, joka perustuu <code>wigglystuff</code>-kirjaston Marimo-widgettiin <code>WebcamCapture</code>. Skripti tallentaa kuvat <code>data/{label}/filename.jpg</code>-polkuun, jossa <code>{label}</code> on vakiona <code>rock</code>, <code>paper</code> tai <code>scissors</code> — on täysin sallittua käyttää muitakin luokkia, kuten <code>pehmolelu|kaukosäädin|kännykkä</code> tai <code>lasit|lippis|pipo</code>.</p>
</div>
<div class="admonition question">
<p class="admonition-title">Tehtävä: RPS ja Transfer Learning</p>
<p>Aja <code>612_rps_transfer_learning.py</code> Marimo Notebook. Skriptissä käytetään edellisessä tehtävässä tallennettua datasettiä ja koulutetaan GoogleNet Inception-v3 -mallia hyödyntäen loppuun liitettyä luokittelijaa. Malli on esikoulutettu ImageNet-datasetillä, joka sisältää 1000 luokkaa, mutta sinulla on vain 3 luokkaa (tai minkä verran niitä päätitkään tehdä).</p>
<p>Tämän koulutus kestää vain joitakin sekunteja, olettaen että et kasaa valtavaa datasettiä.</p>
</div>
<h2 id="lahteet">Lähteet</h2>
<div class="footnote">
<hr />
<ol>
<li id="fn:influence">
<p>Thorndike, E. L. &amp; Woodworth, R. S.. <em>The influence of improvement in one mental function upon the efficiency of other functions</em>. Psychological Review*,1901. https://doi.org/10.1037/h0074898&#160;<a class="footnote-backref" href="#fnref:influence" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:tervekoululainen">
<p>UKK-instituutti. <em>Siirtovaikutus</em>. Terve koululainen. https://tervekoululainen.fi/ylakoulu/liikuntataidot/siirtovaikutus/&#160;<a class="footnote-backref" href="#fnref:tervekoululainen" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:reminder">
<p>Bozinovski, S. <em>Reminder of the First Paper on Transfer Learning in Neural Networks, 1976.</em> 2020. https://doi.org/10.31449/inf.v44i3.2828&#160;<a class="footnote-backref" href="#fnref:reminder" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:reminder" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:aiengineering">
<p>Huyen, C. <em>AI Engineering</em>. O'reilly. 2024.&#160;<a class="footnote-backref" href="#fnref:aiengineering" title="Jump back to footnote 4 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:aiengineering" title="Jump back to footnote 4 in the text">&#8617;</a><a class="footnote-backref" href="#fnref3:aiengineering" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:dlwithpython">
<p>Watson, M &amp; Chollet, F. <em>Deep Learning with Python, Third Edition</em>. Manning. 2025.&#160;<a class="footnote-backref" href="#fnref:dlwithpython" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
<li id="fn:dl4cv">
<p>Rosebrock, A. <em>Deep Learning for Computer Vision with Python. Starter Bundle. 3rd Edition</em>. PyImageSearch. 2019.&#160;<a class="footnote-backref" href="#fnref:dl4cv" title="Jump back to footnote 6 in the text">&#8617;</a></p>
</li>
</ol>
</div>







  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2026 <a href="https://www.kamk.fi">Kajaanin Ammattikorkeakoulu Oy</a>. 
Licenced under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">BY-NC-SA 4.0</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["content.code.copy", "content.code.annotate", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Kopioitu leikep\u00f6yd\u00e4lle", "clipboard.copy": "Kopioi leikep\u00f6yd\u00e4lle", "search.result.more.one": "1 lis\u00e4\u00e4 t\u00e4ll\u00e4 sivulla", "search.result.more.other": "# lis\u00e4\u00e4 t\u00e4ll\u00e4 sivulla", "search.result.none": "Ei t\u00e4sm\u00e4\u00e4vi\u00e4 dokumentteja", "search.result.one": "1 t\u00e4sm\u00e4\u00e4v\u00e4 dokumentti", "search.result.other": "# t\u00e4sm\u00e4\u00e4v\u00e4\u00e4 dokumenttia", "search.result.placeholder": "Kirjoita aloittaaksesi haun", "search.result.term.missing": "Puuttuu", "select.version": "Valitse versio"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>